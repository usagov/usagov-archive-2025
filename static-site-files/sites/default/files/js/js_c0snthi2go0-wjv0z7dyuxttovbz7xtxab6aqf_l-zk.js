/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
var search_input=document.getElementById("search-field-en-small");const dir_search_results=document.getElementById("fed-dir-search-results");let lang=document.documentElement.lang;let search_term="";var allAgencies;function fetchAgencies(){if(lang=="es")return fetch("/sites/default/files/directory_report_federal_es").then((response)=>response.json());else return fetch("/sites/default/files/directory_report_federal").then((response)=>response.json());}function searchAgencies(allAgencies){var returnAgencies=[];var lowerCaseSearchTerm=search_term.toLowerCase();const firstWordExp=new RegExp("^"+lowerCaseSearchTerm+".*");const begWordExp=new RegExp(".* "+lowerCaseSearchTerm);const abbrExp=new RegExp(lowerCaseSearchTerm);allAgencies.forEach((agency)=>{var lowerCaseAgency=agency.agency_title.toLowerCase();if(lowerCaseAgency.match(firstWordExp)||lowerCaseAgency.match(begWordExp))returnAgencies.push(agency);else{if(agency.agency_acronym.toLowerCase().match(abbrExp))returnAgencies.push(agency);};});return returnAgencies;}function showAgencies(filteredAgencies){dir_search_results.innerText="";const usasearch_sayt=document.createElement("div");usasearch_sayt.classList.add("usasearch_sayt");usasearch_sayt.setAttribute("id","usasearch_sayt");const ul=document.createElement("ul");filteredAgencies.forEach((agency,index)=>{const resultBox=document.createElement("li");resultBox.classList.add("resultBox");resultBox.setAttribute("id",`resultBox${index}`);resultBox.setAttribute("role","option");const anchor=document.createElement("a");anchor.onclick=function(){search_input.value=agency.agency_title;};const type=agency.agency_type;if(type=="Federal Directory Record")anchor.href=agency.agency_url;else anchor.href=agency.synonym_url;if(agency.agency_acronym){anchor.innerText=`${agency.agency_title} (${agency.agency_acronym})`;anchor.acronym=agency.agency_acronym;}else anchor.innerText=agency.agency_title;resultBox.appendChild(anchor);ul.appendChild(resultBox);});usasearch_sayt.appendChild(ul);dir_search_results.appendChild(usasearch_sayt);}async function getAgencies(){try{if(!allAgencies)allAgencies=await fetchAgencies();let filteredAgencies=await searchAgencies(allAgencies);await showAgencies(filteredAgencies);}catch(status){}}function listen_for_clear_results(){const fed_dir_results=document.getElementById("usasearch_sayt");if(fed_dir_results)window.addEventListener("click",function(e){if(!fed_dir_results.contains(e.target))dir_search_results.innerText="";});}if(search_input)search_input.addEventListener("input",(e)=>{search_term=e.target.value;if(search_term!="")getAgencies();else dir_search_results.innerText="";listen_for_clear_results();});;
